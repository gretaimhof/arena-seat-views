<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Arena Seat Views</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css">
<script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>

<style>
html, body {
    margin: 0;
    padding: 0;
    background: #00243C;
    font-family: "Roboto Condensed", sans-serif;
    overflow: hidden;
}

#viewer-modal,
#viewer-box,
#panorama,
#arrow-controls,
#section-title,
#back-btn {
    font-family: "Roboto Condensed", sans-serif !important;
}


/* MAP WRAPPER */
#map-wrapper {
    position: fixed;
    inset: 0;
    overflow: hidden;
}

/* Background seating chart */
#seating-bg {
    position: absolute;
    inset: 0;
    width: 100vw;
    height: 100vh;
    object-fit: contain;
    pointer-events: none;
}

/* SVG overlay container */
#overlay-container {
    position: absolute;
    inset: 0;
}

/* Overlay SVG */
#overlay-svg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: auto;
}

/* Transparent default, lighten on hover */
#overlay-svg path {
    fill: rgba(255,255,255,0);
    stroke: transparent;
    transition: fill 0.25s ease;
}
#overlay-svg path:hover {
    fill: rgba(255, 255, 255, 0.466);
    cursor: pointer;
}

/* ===================================================== */
/*                       MODAL VIEWER                    */
/* ===================================================== */
#viewer-modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.75);
    display: none;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity .35s ease;
    cursor: pointer;
}

#viewer-modal.show {
    display: flex;
    opacity: 1;
}

#viewer-box {
    width: min(1100px, 90vw);
    aspect-ratio: 16/9;
    background: #000;
    position: relative;
    cursor: default;
}

#panorama {
    position: absolute;
    inset: 0;
}

/* BACK BUTTON */
#back-btn {
    position: absolute;
    top: 12px;
    left: 40px;
    background: rgba(54,191,237,0.78); /* #36BFED @ 78% opacity */
    color: white;
    border: none;
    padding: 10px 16px;
    font-size: 18px;
    font-weight: 700;
    cursor: pointer;
    z-index: 40;
    backdrop-filter: blur(6px); /* smoother glass look */
    transition: background 0.25s ease;
}

#back-btn:hover {
    background: rgba(54,191,237,0.92); /* brighter, more opaque on hover */
}


/* SECTION TITLE BAR — MATCHES BACK BUTTON */
#section-title {
    position: absolute;
    top: 12px;
    right: 12px;
    background: rgba(54,191,237,0.78); /* translucent aqua */
    color: white;
    padding: 8px 16px;
    font-size: 22px;
    font-weight: 700;
    z-index: 40;
    backdrop-filter: blur(6px);
    pointer-events: none;
    text-transform: uppercase;
    font-family: "Roboto Condensed", sans-serif;
    transition: background 0.25s ease;
}

#section-title:hover {
    background: rgba(54,191,237,0.92); /* brighter hover */
}

#row-tooltip {
    position: fixed;
    padding: 6px 10px;
    background: rgba(0,0,0,0.75);
    color: white;
    font-family: "Roboto Condensed", sans-serif;
    font-size: 16px;
    border-radius: 6px;
    pointer-events: none;
    opacity: 0;
    transform: translate(-50%, -120%);
    transition: opacity 0.15s ease;
    z-index: 9999;
}

</style>
</head>
<body>

<div id="map-wrapper">
    <img id="seating-bg" src="images/seating_chart.png" alt="Arena Seating Chart">
    <div id="overlay-container"></div>
</div>

<!-- 360 VIEWER MODAL -->
<div id="viewer-modal">
    <div id="viewer-box" onclick="event.stopPropagation()">

        <!-- SECTION TITLE BAR -->
        <div id="section-title"></div>
    
        <!-- BACK BUTTON -->
        <button id="back-btn">← Back</button>
    
        <div id="panorama"></div>
    </div>
</div>

<script>
/* =================================================
   LOAD THE SVG OVERLAY + ASSIGN CLICK HANDLERS
   ================================================= */
fetch("images/map_overlay.svg")
    .then(res => res.text())
    .then(svgText => {
        document.getElementById("overlay-container").innerHTML = svgText;

        const svg = document.querySelector("#overlay-container svg");
        svg.id = "overlay-svg";

        const tooltip = document.getElementById("row-tooltip");

svg.querySelectorAll("path").forEach(path => {

    // CLICK — open panorama
    path.addEventListener("click", () => openPanorama(path.id));

    // HOVER IN — show full row range (e.g., "A-C")
    path.addEventListener("mouseenter", (e) => {
        const rows = path.id.split("_")[1];  // "A-C"
        tooltip.innerText = rows.toUpperCase();  
        tooltip.style.opacity = 1;
    });

    // MOVE — follow cursor
    path.addEventListener("mousemove", (e) => {
        tooltip.style.left = e.clientX + "px";
        tooltip.style.top = e.clientY + "px";
    });

    // HOVER OUT — hide
    path.addEventListener("mouseleave", () => {
        tooltip.style.opacity = 0;
    });
});

    });


/* =================================================
      OPEN PANORAMA VIEWER
   ================================================= */
   function openPanorama(pathId) {
    const sectionFolder = pathId.split("_")[0];
    const file = `images/${sectionFolder}/${pathId}.jpg`;

    // Format title: "119_A-C" → "SECTION 119 • ROWS A–C"
    const [sec, rows] = pathId.split("_");
    document.getElementById("section-title").innerText =
        `SECTION ${sec} • ROWS ${rows.toUpperCase()}`;

    // Show modal
    const modal = document.getElementById("viewer-modal");
    modal.style.display = "flex";
    setTimeout(() => modal.classList.add("show"), 10);

    // Clear any old viewer
    document.getElementById("panorama").innerHTML = "";
    if (window.viewer) {
        try { window.viewer.destroy(); } catch (e) {}
    }

    // Create pannellum viewer
    window.viewer = pannellum.viewer("panorama", {
        type: "equirectangular",
        panorama: file,
        autoLoad: true,
        showControls: true,
        compass: false,
        hfov: 100,
        onError: () => alert("Panorama not found:\n" + file)
    });
}


document.getElementById("back-btn").addEventListener("click", closeViewer);


/* =================================================
        CLICK ANYWHERE TO CLOSE VIEWER
   ================================================= */
document.getElementById("viewer-modal").addEventListener("click", closeViewer);

function closeViewer() {
    const modal = document.getElementById("viewer-modal");
    modal.classList.remove("show");
    setTimeout(() => modal.style.display = "none", 300);

    if (window.viewer) {
        try { window.viewer.destroy(); } catch (e) {}
    }
}
</script>
<div id="row-tooltip"></div>
</body>
</html>
